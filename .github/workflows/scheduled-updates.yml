name: Scheduled Updates 

on:
  schedule:
  # Staging Schedule
  # - cron: '10 3 * * *'
  - cron: '10 * * * *'
  - cron: '25 3 * * *' # change last * to sat after testing
  - cron: '40 3 * * sun'

  # Production Schedule
  - cron: '10 4 * * *'
  - cron: '25 4 * * *' # change last * to sat after testing
  - cron: '40 4 * * *' # change last * to sun after testing

jobs:
  run-updater-transactions-current-staging:
    # if: github.event.schedule == '10 3 * * *'
    if: github.event.schedule == '10 * * * *'
    name: Update Transactions Current on Staging
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-transactions-current
          APP_ID: ${{ secrets.STAGING_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}

  run-updater-transactions-past-staging:
    if: github.event.schedule == '25 3 * * *'
    name: Update Transactions Past on Staging
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-transactions-past
          APP_ID: ${{ secrets.STAGING_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}

  run-updater-candidates-current-staging:
    if: github.event.schedule == '40 3 * * sun'
    name: Update Candidates Current on Staging
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-candidates-current
          APP_ID: ${{ secrets.STAGING_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}


  run-update-transactions-current-production:
    if: github.event.schedule == '10 4 * * *'
    name: Update Transactions Current on Production
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-transactions-current
          APP_ID: ${{ secrets.PRODUCTION_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}

  run-update-transactions-past-production:
    if: github.event.schedule == '25 4 * * *'
    name: Update Transactions Past on Production
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-transactions-past
          APP_ID: ${{ secrets.PRODUCTION_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}

  run-update-candidates-current-production:
    if: github.event.schedule == '40 4 * * *'
    name: Update Candidates Current on Production
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: ./.github/actions/updater
        with:
          command: update-candidates-current
          APP_ID: ${{ secrets.PRODUCTION_HEROKU_APP_ID }}
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}
